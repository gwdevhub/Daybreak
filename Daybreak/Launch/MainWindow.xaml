<ui:FluentWindow
    x:Class="Daybreak.Launch.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:buttons="clr-namespace:Daybreak.Controls.Buttons"
    xmlns:controls="clr-namespace:Daybreak.Controls"
    xmlns:converters="clr-namespace:Daybreak.Shared.Converters;assembly=Daybreak.Shared"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:effects="clr-namespace:System.Windows.Media.Extensions.Effects;assembly=WpfExtended"
    xmlns:glyphs="clr-namespace:Daybreak.Controls.Glyphs"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:notifications="clr-namespace:Daybreak.Controls.Notifications"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    x:Name="_this"
    Title="Daybreak"
    d:DesignHeight="450"
    d:DesignWidth="800"
    BorderBrush="Gray"
    Foreground="White"
    Loaded="Window_Loaded"
    ResizeMode="CanResize"
    WindowStyle="None"
    mc:Ignorable="d">
    <Window.Resources>
        <ResourceDictionary>
            <BooleanToVisibilityConverter x:Key="BaseBooleanToVisibilityConverter" />
            <converters:BooleanToEffectConverter x:Key="BooleanToEffectConverter" />
            <effects:Kuwahara
                x:Key="PaintifyEffect"
                TexelHeight="50"
                TexelWidth="200" />
            <BlurEffect
                x:Key="BlurEffect"
                KernelType="Box"
                Radius="3"
                RenderingBias="Performance" />
            <Style x:Key="Window_SettingsButton" TargetType="ToggleButton">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Grid Cursor="Hand">
                                <Rectangle
                                    x:Name="OverlayRect"
                                    Fill="{TemplateBinding Background}"
                                    Opacity="0" />
                                <glyphs:ThreeDotsGlyph Margin="13" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <MultiTrigger.Setters>
                                        <Setter TargetName="OverlayRect" Property="Opacity" Value="1" />
                                    </MultiTrigger.Setters>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <MultiTrigger.Setters>
                                        <Setter TargetName="OverlayRect" Property="Opacity" Value="0" />
                                    </MultiTrigger.Setters>
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Background="Black">
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Border
            Grid.RowSpan="2"
            Grid.ColumnSpan="2"
            BorderBrush="Transparent"
            BorderThickness="0">
            <Border.Effect>
                <effects:ContrastAdjust Brightness="0.01" Contrast="1.3" />
            </Border.Effect>
            <Grid>
                <Border Effect="{Binding ElementName=_this, Path=BlurBackground, Mode=OneWay, Converter={StaticResource BooleanToEffectConverter}, ConverterParameter={StaticResource BlurEffect}}">
                    <Border Effect="{Binding ElementName=_this, Path=PaintifyBackground, Mode=OneWay, Converter={StaticResource BooleanToEffectConverter}, ConverterParameter={StaticResource PaintifyEffect}}">
                        <controls:ImageViewer x:Name="ImageViewer" />
                    </Border>
                </Border>
                <controls:SnowfallOverlay
                    BaseWind1="0.0247"
                    BaseWind2="0.00427"
                    BaseWind3="0.00443"
                    BaseWind4="0.00405"
                    BaseWind5="0.00362"
                    FlakeSize1="14"
                    FlakeSize2="6"
                    FlakeSize3="4.6"
                    FlakeSize4="3.2"
                    FlakeSize5="2.1"
                    Opacity="0.4"
                    Visibility="{Binding ElementName=_this, Path=WintersdayMode, Mode=OneWay, Converter={StaticResource BaseBooleanToVisibilityConverter}}"
                    WindStrength1="0.006"
                    WindStrength2="0.001"
                    WindStrength3="0.00096"
                    WindStrength4="0.00098"
                    WindStrength5="0.0009" />
            </Grid>
        </Border>
        <Rectangle
            Grid.RowSpan="2"
            Grid.ColumnSpan="2"
            Fill="Transparent"
            MouseDown="Window_MouseLeftButtonDown" />
        <buttons:MenuButton
            Title="{Binding ElementName=_this, Path=CreditText, Mode=OneWay}"
            Grid.Row="1"
            Grid.Column="1"
            Margin="0,0,20,30"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Background="Transparent"
            BorderBrush="Transparent"
            BorderThickness="0"
            Clicked="CreditTextBox_MouseLeftButtonDown"
            Cursor="Hand"
            FontSize="22"
            Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}"
            Opacity="0.6"
            ToolTip="Source for background image" />
        <WrapPanel
            Grid.Row="1"
            Grid.Column="1"
            Margin="0,0,20,10"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom">
            <buttons:MenuButton
                Title="{Binding ElementName=_this, Path=CurrentVersionText, Mode=OneWay}"
                Grid.Row="1"
                Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="0"
                Clicked="VersionText_Clicked"
                FontSize="10"
                Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}"
                Opacity="0.6"
                ToolTip="Version Management" />
            <buttons:MenuButton
                Title=" - "
                Grid.Row="1"
                Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="0"
                FontSize="10"
                Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}"
                Opacity="0.6"
                ToolTip="Running with Administrator Rights"
                Visibility="{Binding ElementName=_this, Path=IsRunningAsAdmin, Mode=OneWay, Converter={StaticResource BaseBooleanToVisibilityConverter}}" />
            <buttons:MenuButton
                Title="[Admin]"
                Grid.Row="1"
                Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="0"
                Clicked="AdminText_Clicked"
                FontSize="10"
                Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}"
                Opacity="0.6"
                ToolTip="Running with Administrator Rights"
                Visibility="{Binding ElementName=_this, Path=IsRunningAsAdmin, Mode=OneWay, Converter={StaticResource BaseBooleanToVisibilityConverter}}" />
        </WrapPanel>
        <Grid
            x:Name="Container"
            Grid.Row="1"
            Grid.Column="1" />
        <Grid
            x:Name="MenuContainer"
            Grid.RowSpan="2"
            Width="0"
            HorizontalAlignment="Left"
            VerticalAlignment="Stretch"
            Background="{DynamicResource Daybreak.Brushes.Background}">
            <Border BorderBrush="{DynamicResource MahApps.Brushes.ThemeForeground}" BorderThickness="0,0,1,0" />
            <controls:MenuList Margin="0,30,0,0" />
        </Grid>
        <Grid Grid.ColumnSpan="2">
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <ui:TitleBar ButtonsForeground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}" Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}">
                    <ui:TitleBar.TrailingContent>
                        <StackPanel Orientation="Horizontal">
                            <buttons:HighlightButton
                                Grid.Column="1"
                                Width="44"
                                Height="30"
                                Margin="0,-16,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Clicked="BugButton_Click"
                                Cursor="Hand"
                                HighlightBrush="#1A000000"
                                ToolTip="Report an issue">
                                <buttons:HighlightButton.ButtonContent>
                                    <Grid Width="30" Height="30">
                                        <glyphs:BugGlyph Width="18" Height="18" />
                                    </Grid>
                                </buttons:HighlightButton.ButtonContent>
                            </buttons:HighlightButton>
                            <buttons:HighlightButton
                                Width="44"
                                Height="30"
                                Margin="0,-16,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Clicked="BugButton_Click"
                                Cursor="Hand"
                                HighlightBrush="#1A000000"
                                ToolTip="Report an issue">
                                <buttons:HighlightButton.ButtonContent>
                                    <Grid Width="30" Height="30">
                                        <glyphs:DownloadGlyph Width="18" Height="18" />
                                    </Grid>
                                </buttons:HighlightButton.ButtonContent>
                            </buttons:HighlightButton>
                        </StackPanel>
                    </ui:TitleBar.TrailingContent>
                </ui:TitleBar>
            </StackPanel>
            <ToggleButton
                x:Name="OpeningSettingsButton"
                Grid.ColumnSpan="2"
                Width="50"
                Height="30"
                Margin="0,0,0,0"
                HorizontalAlignment="Left"
                Background="#1A000000"
                Click="SettingsButton_Clicked"
                Foreground="{Binding ElementName=_this, Path=Foreground, Mode=OneWay}"
                Style="{StaticResource Window_SettingsButton}"
                ToolTip="Open Settings" />
            <ToggleButton
                x:Name="ClosingSettingsButton"
                Grid.ColumnSpan="2"
                Width="50"
                Height="30"
                Margin="0,0,0,0"
                HorizontalAlignment="Left"
                Background="{DynamicResource MahApps.Brushes.ThemeBackground}"
                Click="SettingsButton_Clicked"
                Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                Style="{StaticResource Window_SettingsButton}"
                ToolTip="Close Settings"
                Visibility="{Binding ElementName=_this, Path=IsShowingDropdown, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}" />
        </Grid>
        <notifications:NotificationStackpanel
            Grid.Row="1"
            Grid.ColumnSpan="2"
            Width="300"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom" />
    </Grid>
</ui:FluentWindow>