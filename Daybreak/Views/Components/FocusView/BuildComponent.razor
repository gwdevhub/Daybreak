@using Daybreak.Shared.Models.Builds
<div class="container backdrop-panel">
    @if (this.Context is not null)
    {
        <div class="component-title">
            <div class="title-left">
                <div class="title">
                    Builds
                </div>
            </div>
            <div class="title-right">
                <button class="load-button" title="Load current player build" @onclick="this.LoadPlayerSingleBuildClicked">
                    <FluentIcon Value="@(new Icons.Regular.Size16.Person())" />
                </button>
                <button class="load-button" title="Load current team build" @onclick="this.LoadPlayerTeamBuildClicked">
                    <FluentIcon Value="@(new Icons.Regular.Size16.PeopleTeam())" />
                </button>
            </div>
        </div>
        <div class="builds-list @(this.Context.IsInOutpost ? "" : "read-only")">
            @foreach(var build in this.Context.AvailableBuilds)
            {
                <div class="build-entry">
                    <div class="build-name">
                        @build.Name
                    </div>
                    <div class="build-actions">
                        <button class="load-button" title="Load build into game" @onclick="() => this.BuildClicked(build)">
                            <FluentIcon Value="@(new Icons.Regular.Size16.ArrowUp())" />
                        </button>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <SpinnerWidget IsLoading="true" />
    }
</div>

@code {
    [Parameter]
    public required BuildComponentContext? Context { get; init; }
    [Parameter]
    public required Action<IBuildEntry> OnBuildClicked { get; init; }
    [Parameter]
    public required Action OnLoadPlayerSingleBuildClicked { get; init; }
    [Parameter]
    public required Action OnLoadPlayerTeamBuildClicked { get; init; }

    private void BuildClicked(IBuildEntry build)
    {
        this.OnBuildClicked(build);
    }

    private void LoadPlayerSingleBuildClicked()
    {
        this.OnLoadPlayerSingleBuildClicked();
    }

    private void LoadPlayerTeamBuildClicked()
    {
        this.OnLoadPlayerTeamBuildClicked();
    }
}
