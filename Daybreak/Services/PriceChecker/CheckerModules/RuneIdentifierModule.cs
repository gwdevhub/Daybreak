using Daybreak.Models.Guildwars;
using System.Collections.Generic;
using System.Linq;

namespace Daybreak.Services.PriceChecker.CheckerModules;
internal sealed class RuneIdentifierModule : IIdentifierModule
{
    private readonly Dictionary<uint, Rune> runeMapping = new()
    {
        { 0x240801F9, Rune.KnightsInsignia },
        { 0x24080208, Rune.LieutenantsInsignia },
        { 0x24080209, Rune.StonefistInsignia },
        { 0x240801FA, Rune.DreadnoughtInsignia },
        { 0x240801FB, Rune.SentinelsInsignia },
        { 0x240800FC, Rune.RuneOfMinorAbsorption },
        { 0x21E81501, Rune.RuneOfMinorTactics },
        { 0x21E81101, Rune.RuneOfMinorStrength },
        { 0x21E81201, Rune.RuneOfMinorAxeMastery },
        { 0x21E81301, Rune.RuneOfMinorHammerMastery },
        { 0x21E81401, Rune.RuneOfMinorSwordsmanship },
        { 0x240800FD, Rune.RuneOfMajorAbsorption },
        { 0x21E81502, Rune.RuneOfMajorTactics },
        { 0x21E81102, Rune.RuneOfMajorStrength },
        { 0x21E81202, Rune.RuneOfMajorAxeMastery },
        { 0x21E81302, Rune.RuneOfMajorHammerMastery },
        { 0x21E81402, Rune.RuneOfMajorSwordsmanship },
        { 0x240800FE, Rune.RuneOfSuperiorAbsorption },
        { 0x21E81503, Rune.RuneOfSuperiorTactics },
        { 0x21E81103, Rune.RuneOfSuperiorStrength },
        { 0x21E81203, Rune.RuneOfSuperiorAxeMastery },
        { 0x21E81303, Rune.RuneOfSuperiorHammerMastery },
        { 0x21E81403, Rune.RuneOfSuperiorSwordsmanship },
        { 0x240801FC, Rune.FrostboundInsignia },
        { 0x240801FE, Rune.PyreboundInsignia },
        { 0x240801FF, Rune.StormboundInsignia },
        { 0x24080201, Rune.ScoutsInsignia },
        { 0x240801FD, Rune.EarthboundInsignia },
        { 0x24080200, Rune.BeastmastersInsignia },
        { 0x21E81801, Rune.RuneOfMinorWildernessSurvival },
        { 0x21E81701, Rune.RuneOfMinorExpertise },
        { 0x21E81601, Rune.RuneOfMinorBeastMastery },
        { 0x21E81901, Rune.RuneOfMinorMarksmanship },
        { 0x21E81802, Rune.RuneOfMajorWildernessSurvival },
        { 0x21E81702, Rune.RuneOfMajorExpertise },
        { 0x21E81602, Rune.RuneOfMajorBeastMastery },
        { 0x21E81902, Rune.RuneOfMajorMarksmanship },
        { 0x21E81803, Rune.RuneOfSuperiorWildernessSurvival },
        { 0x21E81703, Rune.RuneOfSuperiorExpertise },
        { 0x21E81603, Rune.RuneOfSuperiorBeastMastery },
        { 0x21E81903, Rune.RuneOfSuperiorMarksmanship },
        { 0x240801F6, Rune.WanderersInsignia },
        { 0x240801F7, Rune.DisciplesInsignia },
        { 0x240801F8, Rune.AnchoritesInsignia },
        { 0x21E80D01, Rune.RuneOfMinorHealingPrayers },
        { 0x21E80E01, Rune.RuneOfMinorSmitingPrayers },
        { 0x21E80F01, Rune.RuneOfMinorProtectionPrayers },
        { 0x21E81001, Rune.RuneOfMinorDivineFavor },
        { 0x21E80D02, Rune.RuneOfMajorHealingPrayers },
        { 0x21E80E02, Rune.RuneOfMajorSmitingPrayers },
        { 0x21E80F02, Rune.RuneOfMajorProtectionPrayers },
        { 0x21E81002, Rune.RuneOfMajorDivineFavor },
        { 0x21E80D03, Rune.RuneOfSuperiorHealingPrayers },
        { 0x21E80E03, Rune.RuneOfSuperiorSmitingPrayers },
        { 0x21E80F03, Rune.RuneOfSuperiorProtectionPrayers },
        { 0x21E81003, Rune.RuneOfSuperiorDivineFavor },
        { 0x2408020A, Rune.BloodstainedInsignia },
        { 0x240801EC, Rune.TormentorsInsignia },
        { 0x240801EE, Rune.BonelaceInsignia },
        { 0x240801EF, Rune.MinionMastersInsignia },
        { 0x240801F0, Rune.BlightersInsignia },
        { 0x240801ED, Rune.UndertakersInsignia },
        { 0x21E80401, Rune.RuneOfMinorBloodMagic },
        { 0x21E80501, Rune.RuneOfMinorDeathMagic },
        { 0x21E80701, Rune.RuneOfMinorCurses },
        { 0x21E80601, Rune.RuneOfMinorSoulReaping },
        { 0x21E80402, Rune.RuneOfMajorBloodMagic },
        { 0x21E80502, Rune.RuneOfMajorDeathMagic },
        { 0x21E80702, Rune.RuneOfMajorCurses },
        { 0x21E80602, Rune.RuneOfMajorSoulReaping },
        { 0x21E80403, Rune.RuneOfSuperiorBloodMagic },
        { 0x21E80503, Rune.RuneOfSuperiorDeathMagic },
        { 0x21E80703, Rune.RuneOfSuperiorCurses },
        { 0x21E80603, Rune.RuneOfSuperiorSoulReaping },
        { 0x240801E4, Rune.VirtuososInsignia },
        { 0x240801E2, Rune.ArtificersInsignia },
        { 0x240801E3, Rune.ProdigysInsignia },
        { 0x21E80001, Rune.RuneOfMinorFastCasting },
        { 0x21E80201, Rune.RuneOfMinorDominationMagic },
        { 0x21E80101, Rune.RuneOfMinorIllusionMagic },
        { 0x21E80301, Rune.RuneOfMinorInspirationMagic },
        { 0x21E80002, Rune.RuneOfMajorFastCasting },
        { 0x21E80202, Rune.RuneOfMajorDominationMagic },
        { 0x21E80102, Rune.RuneOfMajorIllusionMagic },
        { 0x21E80302, Rune.RuneOfMajorInspirationMagic },
        { 0x21E80003, Rune.RuneOfSuperiorFastCasting },
        { 0x21E80203, Rune.RuneOfSuperiorDominationMagic },
        { 0x21E80103, Rune.RuneOfSuperiorIllusionMagic },
        { 0x21E80303, Rune.RuneOfSuperiorInspirationMagic },
        { 0x240801F2, Rune.HydromancerInsignia },
        { 0x240801F3, Rune.GeomancerInsignia },
        { 0x240801F4, Rune.PyromancerInsignia },
        { 0x240801F5, Rune.AeromancerInsignia },
        { 0x240801F1, Rune.PrismaticInsignia },
        { 0x21E80C01, Rune.RuneOfMinorEnergyStorage },
        { 0x21E80A01, Rune.RuneOfMinorFireMagic },
        { 0x21E80801, Rune.RuneOfMinorAirMagic },
        { 0x21E80901, Rune.RuneOfMinorEarthMagic },
        { 0x21E80B01, Rune.RuneOfMinorWaterMagic },
        { 0x21E80C02, Rune.RuneOfMajorEnergyStorage },
        { 0x21E80A02, Rune.RuneOfMajorFireMagic },
        { 0x21E80802, Rune.RuneOfMajorAirMagic },
        { 0x21E80902, Rune.RuneOfMajorEarthMagic },
        { 0x21E80B02, Rune.RuneOfMajorWaterMagic },
        { 0x21E80C03, Rune.RuneOfSuperiorEnergyStorage },
        { 0x21E80A03, Rune.RuneOfSuperiorFireMagic },
        { 0x21E80803, Rune.RuneOfSuperiorAirMagic },
        { 0x21E80903, Rune.RuneOfSuperiorEarthMagic },
        { 0x21E80B03, Rune.RuneOfSuperiorWaterMagic },
        { 0x240801DE, Rune.VanguardsInsignia },
        { 0x240801DF, Rune.InfiltratorsInsignia },
        { 0x240801E0, Rune.SaboteursInsignia },
        { 0x240801E1, Rune.NightstalkersInsignia },
        { 0x21E82301, Rune.RuneOfMinorCriticalStrikes },
        { 0x21E81D01, Rune.RuneOfMinorDaggerMastery },
        { 0x21E81E01, Rune.RuneOfMinorDeadlyArts },
        { 0x21E81F01, Rune.RuneOfMinorShadowArts },
        { 0x21E82302, Rune.RuneOfMajorCriticalStrikes },
        { 0x21E81D02, Rune.RuneOfMajorDaggerMastery },
        { 0x21E81E02, Rune.RuneOfMajorDeadlyArts },
        { 0x21E81F02, Rune.RuneOfMajorShadowArts },
        { 0x21E82303, Rune.RuneOfSuperiorCriticalStrikes },
        { 0x21E81D03, Rune.RuneOfSuperiorDaggerMastery },
        { 0x21E81E03, Rune.RuneOfSuperiorDeadlyArts },
        { 0x21E81F03, Rune.RuneOfSuperiorShadowArts },
        { 0x24080204, Rune.ShamansInsignia },
        { 0x24080205, Rune.GhostForgeInsignia },
        { 0x24080206, Rune.MysticsInsignia },
        { 0x21E82201, Rune.RuneOfMinorChannelingMagic },
        { 0x21E82101, Rune.RuneOfMinorRestorationMagic },
        { 0x21E82001, Rune.RuneOfMinorCommuning },
        { 0x21E82401, Rune.RuneOfMinorSpawningPower },
        { 0x21E82202, Rune.RuneOfMajorChannelingMagic },
        { 0x21E82102, Rune.RuneOfMajorRestorationMagic },
        { 0x21E82002, Rune.RuneOfMajorCommuning },
        { 0x21E82402, Rune.RuneOfMajorSpawningPower },
        { 0x21E82203, Rune.RuneOfSuperiorChannelingMagic },
        { 0x21E82103, Rune.RuneOfSuperiorRestorationMagic },
        { 0x21E82003, Rune.RuneOfSuperiorCommuning },
        { 0x21E82403, Rune.RuneOfSuperiorSpawningPower },
        { 0x24080202, Rune.WindwalkerInsignia },
        { 0x24080203, Rune.ForsakenInsignia },
        { 0x21E82C01, Rune.RuneOfMinorMysticism },
        { 0x21E82B01, Rune.RuneOfMinorEarthPrayers },
        { 0x21E82901, Rune.RuneOfMinorScytheMastery },
        { 0x21E82A01, Rune.RuneOfMinorWindPrayers },
        { 0x21E82C02, Rune.RuneOfMajorMysticism },
        { 0x21E82B02, Rune.RuneOfMajorEarthPrayers },
        { 0x21E82902, Rune.RuneOfMajorScytheMastery },
        { 0x21E82A02, Rune.RuneOfMajorWindPrayers },
        { 0x21E82C03, Rune.RuneOfSuperiorMysticism },
        { 0x21E82B03, Rune.RuneOfSuperiorEarthPrayers },
        { 0x21E82903, Rune.RuneOfSuperiorScytheMastery },
        { 0x21E82A03, Rune.RuneOfSuperiorWindPrayers },
        { 0x24080207, Rune.CenturionsInsignia },
        { 0x21E82801, Rune.RuneOfMinorLeadership },
        { 0x21E82701, Rune.RuneOfMinorMotivation },
        { 0x21E82601, Rune.RuneOfMinorCommand },
        { 0x21E82501, Rune.RuneOfMinorSpearMastery },
        { 0x21E82802, Rune.RuneOfMajorLeadership },
        { 0x21E82702, Rune.RuneOfMajorMotivation },
        { 0x21E82602, Rune.RuneOfMajorCommand },
        { 0x21E82502, Rune.RuneOfMajorSpearMastery },
        { 0x21E82803, Rune.RuneOfSuperiorLeadership },
        { 0x21E82703, Rune.RuneOfSuperiorMotivation },
        { 0x21E82603, Rune.RuneOfSuperiorCommand },
        { 0x21E82503, Rune.RuneOfSuperiorSpearMastery },
        { 0x240801E6, Rune.SurvivorInsignia },
        { 0x240801E5, Rune.RadiantInsignia },
        { 0x240801E7, Rune.StalwartInsignia },
        { 0x240801E8, Rune.BrawlersInsignia },
        { 0x240801E9, Rune.BlessedInsignia },
        { 0x240801EA, Rune.HeraldsInsignia },
        { 0x240801EB, Rune.SentrysInsignia },
        { 0x24080211, Rune.RuneOfAttunement },
        { 0x24080213, Rune.RuneOfRecovery },
        { 0x24080214, Rune.RuneOfRestoration },
        { 0x24080215, Rune.RuneOfClarity },
        { 0x24080216, Rune.RuneOfPurity },
        { 0x240800C2, Rune.RuneOfMinorVigor },
        { 0x24080101, Rune.RuneOfSuperiorVigor },
        { 0x24080100, Rune.RuneOfMajorVigor },
        { 0x24080212, Rune.RuneOfVitae },
    };

    public IEnumerable<ItemBase> IdentifyItems(IBagContent item)
    {
        if (item.Modifiers is null)
        {
            return [];
        }

        return item.Modifiers.Select(m =>
        {
            if (this.runeMapping.TryGetValue(m, out var rune))
            {
                return rune;
            }

            return null;
        }).OfType<Rune>();
    }
}
